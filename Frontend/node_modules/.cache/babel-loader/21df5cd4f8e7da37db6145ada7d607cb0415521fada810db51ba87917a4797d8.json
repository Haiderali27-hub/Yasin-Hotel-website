{"ast":null,"code":"import{useEffect,useState}from'react';import{Link,useNavigate}from'react-router-dom';import AdminLayout from'../components/AdminLayout';import{authUtils}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminDashboard=()=>{const navigate=useNavigate();const[stats,setStats]=useState({users:0,rooms:0,bookings:0});const[loading,setLoading]=useState(true);const[error,setError]=useState('');const[adminInfo,setAdminInfo]=useState(null);useEffect(()=>{// Check authentication\nconst token=authUtils.getToken();const savedAdminInfo=localStorage.getItem('adminInfo');if(!token){console.log('❌ No token found, redirecting to login');navigate('/admin/login');return;}if(savedAdminInfo){try{setAdminInfo(JSON.parse(savedAdminInfo));}catch(e){console.error('Error parsing admin info:',e);}}console.log('✅ Token found, loading dashboard');fetchStats();// eslint-disable-next-line\n},[navigate]);const fetchStats=async()=>{setLoading(true);setError('');try{const token=localStorage.getItem('token')||localStorage.getItem('adminToken');const headers={Authorization:\"Bearer \".concat(token)};const[usersRes,roomsRes,bookingsRes]=await Promise.all([fetch('/api/users',{headers}),fetch('/api/rooms',{headers}),fetch('/api/bookings',{headers})]);if(!usersRes.ok||!roomsRes.ok||!bookingsRes.ok)throw new Error('Failed to fetch stats');const users=await usersRes.json();const rooms=await roomsRes.json();const bookings=await bookingsRes.json();setStats({users:users.length,rooms:rooms.length,bookings:bookings.length});}catch(err){setError('Failed to load dashboard stats');}setLoading(false);};const handleLogout=()=>{localStorage.removeItem('adminToken');navigate('/admin/login');};return/*#__PURE__*/_jsx(AdminLayout,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"admin-dashboard-container\",style:{padding:'2rem'},children:[adminInfo&&/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#d4edda',border:'1px solid #c3e6cb',color:'#155724',padding:'1rem',borderRadius:'4px',marginBottom:'2rem'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u2705 Welcome to Admin Dashboard!\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Logged in as:\"}),\" \",adminInfo.name,\" (\",adminInfo.email,\")\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Role:\"}),\" \",adminInfo.role]}),/*#__PURE__*/_jsx(\"p\",{children:\"\\uD83C\\uDF89 Login successful! All systems are working.\"})]}),/*#__PURE__*/_jsx(\"h2\",{children:\"Admin Dashboard\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading stats...\"}):error?/*#__PURE__*/_jsxs(\"div\",{style:{backgroundColor:'#f8d7da',border:'1px solid #f5c6cb',color:'#721c24',padding:'1rem',borderRadius:'4px'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Note:\"}),\" \",error]}),/*#__PURE__*/_jsx(\"p\",{children:\"This is normal - some API endpoints require additional setup.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Your login system is working perfectly!\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Users\"}),/*#__PURE__*/_jsx(\"p\",{children:stats.users}),/*#__PURE__*/_jsx(Link,{to:\"/admin/users\",children:\"Manage Users\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Rooms\"}),/*#__PURE__*/_jsx(\"p\",{children:stats.rooms}),/*#__PURE__*/_jsx(Link,{to:\"/admin/rooms\",children:\"Manage Rooms\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Total Bookings\"}),/*#__PURE__*/_jsx(\"p\",{children:stats.bookings}),/*#__PURE__*/_jsx(Link,{to:\"/admin/bookings\",children:\"Manage Bookings\"})]})]}),/*#__PURE__*/_jsx(\"nav\",{children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/admin/rooms\",children:\"Manage Rooms\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/admin/bookings\",children:\"Manage Bookings\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/admin/users\",children:\"Manage Users\"})})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"})]})});};export default AdminDashboard;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}