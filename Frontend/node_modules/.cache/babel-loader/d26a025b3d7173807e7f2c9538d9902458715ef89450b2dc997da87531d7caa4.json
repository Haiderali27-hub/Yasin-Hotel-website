{"ast":null,"code":"import _objectSpread from\"c:/Users/DELL/Desktop/Yasin Heaven Star Hotel/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import AdminLayout from'../components/AdminLayout';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminBookings=()=>{const[bookings,setBookings]=useState([]);const[form,setForm]=useState({user:'',room:'',checkIn:'',checkOut:'',status:'booked'});const[editingId,setEditingId]=useState(null);const[error,setError]=useState('');const fetchBookings=async()=>{const res=await fetch('/api/bookings',{headers:{Authorization:'Bearer '+localStorage.getItem('adminToken')}});setBookings(await res.json());};useEffect(()=>{fetchBookings();},[]);const handleChange=e=>setForm(_objectSpread(_objectSpread({},form),{},{[e.target.name]:e.target.value}));const handleSubmit=async e=>{e.preventDefault();setError('');try{const method=editingId?'PUT':'POST';const url=editingId?\"/api/bookings/\".concat(editingId):'/api/bookings';const res=await fetch(url,{method,headers:{'Content-Type':'application/json',Authorization:'Bearer '+localStorage.getItem('adminToken')},body:JSON.stringify(form)});if(!res.ok)throw new Error('Error saving booking');setForm({user:'',room:'',checkIn:'',checkOut:'',status:'booked'});setEditingId(null);fetchBookings();}catch(err){setError('Failed to save booking');}};const handleEdit=booking=>{var _booking$user,_booking$room,_booking$checkIn,_booking$checkOut;setForm({user:((_booking$user=booking.user)===null||_booking$user===void 0?void 0:_booking$user._id)||booking.user,room:((_booking$room=booking.room)===null||_booking$room===void 0?void 0:_booking$room._id)||booking.room,checkIn:(_booking$checkIn=booking.checkIn)===null||_booking$checkIn===void 0?void 0:_booking$checkIn.slice(0,10),checkOut:(_booking$checkOut=booking.checkOut)===null||_booking$checkOut===void 0?void 0:_booking$checkOut.slice(0,10),status:booking.status});setEditingId(booking._id);};const handleDelete=async id=>{if(!window.confirm('Delete this booking?'))return;await fetch(\"/api/bookings/\".concat(id),{method:'DELETE',headers:{Authorization:'Bearer '+localStorage.getItem('adminToken')}});fetchBookings();};return/*#__PURE__*/_jsx(AdminLayout,{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Manage Bookings\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{name:\"user\",placeholder:\"User ID\",value:form.user,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"room\",placeholder:\"Room ID\",value:form.room,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"checkIn\",type:\"date\",value:form.checkIn,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(\"input\",{name:\"checkOut\",type:\"date\",value:form.checkOut,onChange:handleChange,required:true}),/*#__PURE__*/_jsxs(\"select\",{name:\"status\",value:form.status,onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"booked\",children:\"Booked\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cancelled\",children:\"Cancelled\"}),/*#__PURE__*/_jsx(\"option\",{value:\"completed\",children:\"Completed\"})]}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",children:[editingId?'Update':'Add',\" Booking\"]}),error&&/*#__PURE__*/_jsx(\"span\",{className:\"error\",children:error})]}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"User\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Room\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Check In\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Check Out\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:bookings.map(booking=>{var _booking$user2,_booking$room2,_booking$checkIn2,_booking$checkOut2;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:((_booking$user2=booking.user)===null||_booking$user2===void 0?void 0:_booking$user2.name)||booking.user}),/*#__PURE__*/_jsx(\"td\",{children:((_booking$room2=booking.room)===null||_booking$room2===void 0?void 0:_booking$room2.number)||booking.room}),/*#__PURE__*/_jsx(\"td\",{children:(_booking$checkIn2=booking.checkIn)===null||_booking$checkIn2===void 0?void 0:_booking$checkIn2.slice(0,10)}),/*#__PURE__*/_jsx(\"td\",{children:(_booking$checkOut2=booking.checkOut)===null||_booking$checkOut2===void 0?void 0:_booking$checkOut2.slice(0,10)}),/*#__PURE__*/_jsx(\"td\",{children:booking.status}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEdit(booking),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(booking._id),children:\"Delete\"})]})]},booking._id);})})]})]})});};export default AdminBookings;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}