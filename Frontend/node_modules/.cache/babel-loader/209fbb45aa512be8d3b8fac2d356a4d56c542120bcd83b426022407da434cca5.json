{"ast":null,"code":"import{useEffect,useState}from'react';import{FaCalendarAlt,FaCheckCircle,FaClock,FaEdit,FaMapMarkerAlt,FaSignInAlt,FaTimesCircle,FaTrash,FaUserPlus,FaUsers}from'react-icons/fa';import{Link,useNavigate}from'react-router-dom';import{authUtils,bookingAPI}from'../services/api';import'./BookingPage.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const BookingPage=()=>{const[activeTab,setActiveTab]=useState('all');const[isAuthenticated,setIsAuthenticated]=useState(false);const[user,setUser]=useState(null);const[bookings,setBookings]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const navigate=useNavigate();useEffect(()=>{checkAuthentication();},[]);useEffect(()=>{if(isAuthenticated){fetchUserBookings();}},[isAuthenticated]);const checkAuthentication=()=>{const token=authUtils.getToken();const userType=localStorage.getItem('userType');if(token&&userType==='user'){setIsAuthenticated(true);const userInfo=localStorage.getItem('userInfo');if(userInfo){setUser(JSON.parse(userInfo));}}else{setIsAuthenticated(false);setLoading(false);}};const fetchUserBookings=async()=>{try{setLoading(true);setError('');const response=await bookingAPI.getUserBookings();setBookings(response.data);}catch(err){console.error('Error fetching bookings:',err);setError('Failed to load bookings. Please try again.');}finally{setLoading(false);}};const getFilteredBookings=()=>{const now=new Date();switch(activeTab){case'upcoming':return bookings.filter(booking=>new Date(booking.checkIn)>now&&booking.status!=='cancelled');case'past':return bookings.filter(booking=>new Date(booking.checkOut)<now||booking.status==='completed');case'cancelled':return bookings.filter(booking=>booking.status==='cancelled');default:return bookings;}};const getStatusIcon=status=>{switch(status){case'booked':return/*#__PURE__*/_jsx(FaCheckCircle,{className:\"status-icon booked\"});case'cancelled':return/*#__PURE__*/_jsx(FaTimesCircle,{className:\"status-icon cancelled\"});case'completed':return/*#__PURE__*/_jsx(FaCheckCircle,{className:\"status-icon completed\"});case'checked-in':return/*#__PURE__*/_jsx(FaClock,{className:\"status-icon checked-in\"});default:return/*#__PURE__*/_jsx(FaClock,{className:\"status-icon\"});}};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{weekday:'short',year:'numeric',month:'short',day:'numeric'});};const calculateNights=(checkIn,checkOut)=>{const diffTime=Math.abs(new Date(checkOut)-new Date(checkIn));return Math.ceil(diffTime/(1000*60*60*24));};// If user is not authenticated, show login prompt\nif(!isAuthenticated){return/*#__PURE__*/_jsx(\"div\",{className:\"booking-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-prompt\",style:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',minHeight:'70vh',textAlign:'center',backgroundColor:'#f9fafb',border:'2px dashed #e5e7eb',borderRadius:'12px',padding:'40px',margin:'20px 0'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'4rem',color:'#dc2626',marginBottom:'20px'},children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"h1\",{style:{fontSize:'2.5rem',fontWeight:'bold',color:'#1f2937',marginBottom:'16px'},children:\"Login Required\"}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'1.2rem',color:'#6b7280',marginBottom:'30px',maxWidth:'600px'},children:\"You need to be logged in to view and manage your bookings. Please sign in to access your booking history, upcoming reservations, and manage your account.\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'20px',flexWrap:'wrap',justifyContent:'center'},children:[/*#__PURE__*/_jsxs(Link,{to:\"/login\",style:{display:'flex',alignItems:'center',gap:'10px',backgroundColor:'#dc2626',color:'white',padding:'12px 30px',borderRadius:'8px',textDecoration:'none',fontSize:'1.1rem',fontWeight:'600',transition:'all 0.3s ease',boxShadow:'0 4px 6px rgba(0, 0, 0, 0.1)'},onMouseOver:e=>e.target.style.backgroundColor='#b91c1c',onMouseOut:e=>e.target.style.backgroundColor='#dc2626',children:[/*#__PURE__*/_jsx(FaSignInAlt,{}),\"Sign In\"]}),/*#__PURE__*/_jsxs(Link,{to:\"/signup\",style:{display:'flex',alignItems:'center',gap:'10px',backgroundColor:'transparent',color:'#dc2626',border:'2px solid #dc2626',padding:'12px 30px',borderRadius:'8px',textDecoration:'none',fontSize:'1.1rem',fontWeight:'600',transition:'all 0.3s ease'},onMouseOver:e=>{e.target.style.backgroundColor='#dc2626';e.target.style.color='white';},onMouseOut:e=>{e.target.style.backgroundColor='transparent';e.target.style.color='#dc2626';},children:[/*#__PURE__*/_jsx(FaUserPlus,{}),\"Create Account\"]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'40px',padding:'20px',backgroundColor:'#fef3c7',border:'1px solid #f59e0b',borderRadius:'8px',maxWidth:'500px'},children:[/*#__PURE__*/_jsx(\"h3\",{style:{color:'#92400e',marginBottom:'10px',fontSize:'1.1rem'},children:\"Why create an account?\"}),/*#__PURE__*/_jsxs(\"ul\",{style:{color:'#92400e',textAlign:'left',margin:0,paddingLeft:'20px'},children:[/*#__PURE__*/_jsx(\"li\",{children:\"View your booking history\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Manage upcoming reservations\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Access exclusive member deals\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Faster checkout process\"}),/*#__PURE__*/_jsx(\"li\",{children:\"24/7 customer support\"})]})]})]})})});}return/*#__PURE__*/_jsx(\"div\",{className:\"booking-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"page-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"My Bookings\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Manage your room reservations and view booking history\"}),/*#__PURE__*/_jsxs(Link,{to:\"/book-room\",className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(FaCalendarAlt,{}),\" Book New Room\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking-tabs\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"tab \".concat(activeTab==='all'?'active':''),onClick:()=>setActiveTab('all'),children:[\"All Bookings (\",bookings.length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"tab \".concat(activeTab==='upcoming'?'active':''),onClick:()=>setActiveTab('upcoming'),children:[\"Upcoming (\",getFilteredBookings().length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"tab \".concat(activeTab==='past'?'active':''),onClick:()=>setActiveTab('past'),children:[\"Past (\",getFilteredBookings().length,\")\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"tab \".concat(activeTab==='cancelled'?'active':''),onClick:()=>setActiveTab('cancelled'),children:[\"Cancelled (\",getFilteredBookings().length,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bookings-content\",children:loading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading your bookings...\"})]}):error?/*#__PURE__*/_jsxs(\"div\",{className:\"error-state\",children:[/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:fetchUserBookings,className:\"btn btn-primary\",children:\"Try Again\"})]}):getFilteredBookings().length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCC5\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No bookings found\"}),/*#__PURE__*/_jsx(\"p\",{children:activeTab==='all'?\"You haven't made any bookings yet.\":\"No \".concat(activeTab,\" bookings found.\")}),/*#__PURE__*/_jsxs(Link,{to:\"/book-room\",className:\"btn btn-primary\",children:[/*#__PURE__*/_jsx(FaCalendarAlt,{}),\" Make Your First Booking\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"bookings-grid\",children:getFilteredBookings().map(booking=>{var _booking$room,_booking$room2,_booking$room3;return/*#__PURE__*/_jsxs(\"div\",{className:\"booking-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"booking-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"booking-status\",children:[getStatusIcon(booking.status),/*#__PURE__*/_jsx(\"span\",{className:\"status-text \".concat(booking.status),children:booking.status.charAt(0).toUpperCase()+booking.status.slice(1)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking-id\",children:[\"#\",booking._id.slice(-6)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"room-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:((_booking$room=booking.room)===null||_booking$room===void 0?void 0:_booking$room.type)||'Room'}),/*#__PURE__*/_jsxs(\"p\",{className:\"room-number\",children:[\"Room \",(_booking$room2=booking.room)===null||_booking$room2===void 0?void 0:_booking$room2.number]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking-dates\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"date-item\",children:[/*#__PURE__*/_jsx(FaCalendarAlt,{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Check-in\"}),/*#__PURE__*/_jsx(\"span\",{children:formatDate(booking.checkIn)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"date-item\",children:[/*#__PURE__*/_jsx(FaCalendarAlt,{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Check-out\"}),/*#__PURE__*/_jsx(\"span\",{children:formatDate(booking.checkOut)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(FaClock,{}),/*#__PURE__*/_jsxs(\"span\",{children:[calculateNights(booking.checkIn,booking.checkOut),\" night\",calculateNights(booking.checkIn,booking.checkOut)>1?'s':'']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(FaUsers,{}),/*#__PURE__*/_jsxs(\"span\",{children:[booking.guests||1,\" guest\",(booking.guests||1)>1?'s':'']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(FaMapMarkerAlt,{}),/*#__PURE__*/_jsx(\"span\",{children:\"Yasin Heaven Star Hotel\"})]})]}),booking.customerInfo&&/*#__PURE__*/_jsxs(\"div\",{className:\"customer-info\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Guest:\"}),\" \",booking.customerInfo.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",booking.customerInfo.email]}),booking.customerInfo.phone&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Phone:\"}),\" \",booking.customerInfo.phone]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"booking-total\",children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"Total: $\",booking.totalAmount||((_booking$room3=booking.room)===null||_booking$room3===void 0?void 0:_booking$room3.price)*calculateNights(booking.checkIn,booking.checkOut)]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking-actions\",children:[booking.status==='booked'&&new Date(booking.checkIn)>new Date()&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline\",children:[/*#__PURE__*/_jsx(FaEdit,{}),\" Modify\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-secondary\",children:[/*#__PURE__*/_jsx(FaTrash,{}),\" Cancel\"]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",children:\"View Details\"})]})]},booking._id);})})}),bookings.length===0&&!loading&&!error&&/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-section\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome to Yasin Heaven Star Hotel! \\uD83C\\uDF1F\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Start your journey with us by booking your first room.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"features-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"feature\",children:[/*#__PURE__*/_jsx(FaCheckCircle,{}),/*#__PURE__*/_jsx(\"h4\",{children:\"Easy Booking\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Quick and simple room reservation process\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"feature\",children:[/*#__PURE__*/_jsx(FaCalendarAlt,{}),/*#__PURE__*/_jsx(\"h4\",{children:\"Flexible Dates\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Choose from available dates that suit you\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"feature\",children:[/*#__PURE__*/_jsx(FaUsers,{}),/*#__PURE__*/_jsx(\"h4\",{children:\"Family Friendly\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Rooms for individuals, couples, and families\"})]})]})]})]})});};export default BookingPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}